# 🚕 Astana Taxi Analytics

Система аналитики такси с использованием LangChain, OpenAI и FastAPI для анализа GPS данных и поездок такси в Астане.

## 🎯 Возможности

- **Обработка GPS данных** - 1.2+ млн записей с координатами и скоростью
- **Анализ поездок такси** - 200+ тыс. записей с детализацией
- **AI-аналитика** - Классификация районов, типов дорог, эффективности поездок
- **Тепловые карты** - Визуализация активности по городу
- **REST API** - Полноценный API для интеграции
- **Веб-дашборд** - Интерактивный интерфейс

## 🚀 Быстрый старт

См. [START.md](START.md) для быстрого запуска.

## 📊 Данные

### GPS данные
- **Файл:** `data/geo_locations_astana_hackathon.csv`
- **Записей:** 1,262,687
- **Поля:** широта, долгота, высота, скорость, азимут

### Данные такси
- **Файл:** `data/Taxi_Set.csv`
- **Записей:** 207,596
- **Поля:** длительность, расстояние, стоимость, пассажиры, surge pricing

## 🏗️ Архитектура

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   CSV Data      │    │   LangChain     │    │   FastAPI       │
│   (GPS + Taxi)  │───▶│   + OpenAI      │───▶│   Backend       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                                       │
                       ┌─────────────────┐            │
                       │   SQLite DB     │◀───────────┘
                       │   (Processed)   │
                       └─────────────────┘
                                │
                       ┌─────────────────┐
                       │   Web Dashboard │
                       │   (HTML/JS)     │
                       └─────────────────┘
```

## 🔧 Технологии

- **Backend:** FastAPI, SQLAlchemy, Uvicorn
- **AI:** LangChain, OpenAI GPT
- **Data:** Pandas, NumPy
- **Database:** SQLite
- **Frontend:** HTML, JavaScript, Folium
- **Visualization:** Heatmaps, Interactive maps

## 📁 Структура проекта

```
📁 data/                           # Исходные данные
├── geo_locations_astana_hackathon.csv
└── Taxi_Set.csv

📁 backend/                        # Backend API
├── main.py                       # FastAPI приложение
├── models.py                     # SQLAlchemy модели
├── database_service.py           # Работа с БД
├── data_processor.py             # Обработка через LLM
├── config.py                     # Конфигурация
└── simple_init_database.py       # Инициализация БД

📁 html/                          # Веб-интерфейс
├── fullsite.html                 # Полный дашборд
├── dashboard.html                # Основной дашборд
└── heatmap.html                  # Тепловая карта

📄 run_backend.py                 # Полный запуск с OpenAI
📄 run_backend_simple.py          # Упрощенный запуск
📄 start_backend.bat              # Windows: полный запуск
📄 start_simple_backend.bat       # Windows: простой запуск
📄 requirements.txt               # Python зависимости
```

## 🔑 API Endpoints

- `GET /` - Главная страница API
- `GET /health` - Проверка состояния
- `GET /docs` - Swagger документация
- `GET /gps-data` - GPS данные
- `GET /taxi-data` - Данные такси
- `GET /heatmap-data` - Данные для тепловой карты
- `GET /analytics-metrics` - Аналитические метрики
- `GET /dashboard-data` - Данные для дашборда
- `POST /process-data` - Запуск обработки данных

## 🤖 AI Аналитика

### GPS данные
- **Классификация районов:** Север/Центр/Юг по широте
- **Уровень активности:** Высокий/Средний/Низкий по скорости
- **Тип дороги:** Шоссе/Улица/Жилой район

### Данные такси
- **Категория поездки:** Короткая/Средняя/Длинная
- **Ценовая категория:** Низкая/Средняя/Высокая/Премиум
- **Эффективность:** Оценка 0-1 по скорости и времени

## 🛠️ Установка

1. **Клонируйте репозиторий**
2. **Установите зависимости:** `pip install -r requirements.txt`
3. **Поместите данные** в папку `data/`
4. **Запустите:** `python run_backend_simple.py`

## 📈 Производительность

- **GPS данные:** ~1.2M записей обрабатываются за 5-10 минут
- **Данные такси:** ~200K записей обрабатываются за 2-5 минут
- **API:** Обработка запросов < 100ms
- **Память:** ~2-4GB RAM для полной обработки

## 🔒 Безопасность

- CORS настроен для локальной разработки
- API ключи хранятся в переменных окружения
- SQLite база данных локальная

## 📝 Лицензия

Проект создан для хакатона Astana Hackathon.

## 🤝 Поддержка

При возникновении проблем:
1. Проверьте [START.md](START.md)
2. Убедитесь в наличии всех зависимостей
3. Проверьте файлы данных в папке `data/`